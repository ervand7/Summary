```
import boto3
from botocore.exceptions import ClientError

dynamodb = boto3.resource("dynamodb")
table = dynamodb.Table("IdempotencyTable")

try:
    table.put_item(
        Item={
            "idempotency_key": "abc-123",
            "status": "DONE"
        },
        ConditionExpression="attribute_not_exists(idempotency_key)"
    )
    print("Write succeeded")

except ClientError as e:
    if e.response["Error"]["Code"] == "ConditionalCheckFailedException":
        print("Duplicate request â€” already processed")
    else:
        raise
```